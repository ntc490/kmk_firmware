# Higher level Keyboard config like layers
#
# Keymappings adapted from:
# https://peterxjang.com/blog/designing-a-36-key-custom-keyboard-layout.html
#
# QWERTY [base layer]
# ,-----.-----.-----.-----.-----.                      ,-----.-----.-----.-----.-----.
# | Q   | W   | E   | R   | T   |                      | Y   | U   | I   | O   | P   |
# |-----+-----+-----+-----+-----|                      |-----+-----+-----+-----+-----|
# | A   | S   | D   | F   | G   |                      | H   | J   | K   | L   | ; : |
# |-----+-----+-----+-----+-----+                      |-----+-----+-----+-----+-----|
# |SHF/Z| X   | C   | V   | B   |                      | N   | M   | , < | . > |SHF/?|
# `-----'-----'-----'-----'-----'                      `-----'-----'-----'-----'-----'
#               .-------.-------.-------.      .-------.-------.-------.
#               |GUI/ESC|CTR/TAB|ALT/PWR|      |FKY/BSP|NUM/ENT|HYP/SPC|
#               '-------'-------'-------'      '-------'-------'-------'
#
# Colemak [base layer]
# ,-----.-----.-----.-----.-----.                      ,-----.-----.-----.-----.-----.
# | Q   | W   | F   | P   | B   |                      | J   | L   | U   | Y   | ; : |
# |-----+-----+-----+-----+-----|                      |-----+-----+-----+-----+-----|
# | A   | R   | S   | T   | G   |                      | M   | N   | E   | I   | O   |
# |-----+-----+-----+-----+-----+                      |-----+-----+-----+-----+-----|
# |SHF/Z| X   | C   | D   | V   |                      | K   | H   | , < | . > |SHF/?|
# `-----'-----'-----'-----'-----'                      `-----'-----'-----'-----'-----'
#               .-------.-------.-------.      .-------.-------.-------.
#               |GUI/ESC|CTR/TAB|ALT/PWR|      |FKY/BSP|NUM/ENT|HYP/SPC|
#               '-------'-------'-------'      '-------'-------'-------'
#
# Numbers
# ,-----.-----.-----.-----.-----.                      ,-----.-----.-----.-----.-----.
# | 1 ! | 2 @ | 3 # | 4 $ | 5 % |                      | 6 ^ | 7 & | 8 * | 9 ( | 0 ) |
# |-----+-----+-----+-----+-----|                      |-----+-----+-----+-----+-----|
# | ` ~ |HOME |PGUP |PGDN | END |                      |LEFT |DOWN | UP  |RGHT | ' " |
# |-----+-----+-----+-----+-----+                      |-----+-----+-----+-----+-----|
# |SHFT | = + | [ { | ] } | - _ |                      |NXTWN| XXX | XXX | XXX |SHF\||
# `-----'-----'-----'-----'-----'                      `-----'-----'-----'-----'-----'
#               .-------.-------.-------.      .-------.-------.-------.
#               |       |       |       |      | BKSP  |(hold) |       |
#               '-------'-------'-------'      '-------'-------'-------'
#
# Power
# ,-----.-----.-----.-----.-----.                      ,-----.-----.-----.-----.-----.
# | TAB | XXX | XXX | XXX | XXX |                      | XXX | XXX | XXX | XXX |  _  |
# |-----+-----+-----+-----+-----|                      |-----+-----+-----+-----+-----|
# |^TAB | XXX | XXX | XXX | XXX |                      | - _ |LKUP | RET | XXX |  +  |
# |-----+-----+-----+-----+-----+                      |-----+-----+-----+-----+-----|
# |     | XXX | XXX | XXX | XXX |                      |USNAK|SNAKE|CAMEL|KEBAB|     |
# `-----'-----'-----'-----'-----'                      `-----'-----'-----'-----'-----'
#               .-------.-------.-------.      .-------.-------.-------.
#               |       |       |(hold2)|      | BKSP  | ENTER | SPACE |
#               '-----------------------'      '-------'-------'-------'
#
# Function keys
# ,-----.-----.-----.-----.-----.                      ,-----.-----.-----.-----.-----.
# | F1  | F2  | F3  | F4  | F5  |                      | F6  | F7  | F8  | F9  | F10 |
# |-----+-----+-----+-----+-----|                      |-----+-----+-----+-----+-----|
# | F11 | F12 | XXX | XXX | XXX |                      |MLEFT|MDOWN| MUP |MRGHT| XXX |
# |-----+-----+-----+-----+-----+                      |-----+-----+-----+-----+-----|
# | SHFT| XXX |CAPS |QWERT|COLEM|                      |BTN1 | BTN2| XXX | XXX |SHFT |
# `-----'-----'-----'-----'-----'                      `-----'-----'-----'-----'-----'
#               .-------.-------.-------.      .-------.-------.-------.
#               |       |       |       |      |(hold) |       | SPACE |
#               '-----------------------'      '-------'-------'-------'
#
# Uppercase Snake
# ,-----.-----.-----.-----.-----.                      ,-----.-----.-----.-----.-----.
# | Q   | W   | E   | R   | T   |                      | Y   | U   | I   | O   | P   |
# |-----+-----+-----+-----+-----|                      |-----+-----+-----+-----+-----|
# | A   | S   | D   | F   | G   |   (ucase letters)    | H   | J   | K   | L   |     |
# |-----+-----+-----+-----+-----+                      |-----+-----+-----+-----+-----|
# |     | X   | C   | V   | B   |                      | N   | M   |     |     |     |
# `-----'-----'-----'-----'-----'                      `-----'-----'-----'-----'-----'
#               .-------.-------.-------.      .-------.-------.-------.
#               |       |       |       |      | EXIT  |       |   _   |
#               '-----------------------'      '-------'-------'-------'
#
# Snake
# ,-----.-----.-----.-----.-----.                      ,-----.-----.-----.-----.-----.
# |     |     |     |     |     |                      |     |     |     |     |     |
# |-----+-----+-----+-----+-----|                      |-----+-----+-----+-----+-----|
# |     |     |     |     |     |                      |     |     |     |     |     |
# |-----+-----+-----+-----+-----+                      |-----+-----+-----+-----+-----|
# |     |     |     |     |     |                      |     |     |     |     |     |
# `-----'-----'-----'-----'-----'                      `-----'-----'-----'-----'-----'
#               .-------.-------.-------.      .-------.-------.-------.
#               |       |       |       |      | EXIT  |       |   _   |
#               '-----------------------'      '-------'-------'-------'
#
# Camel
# ,-----.-----.-----.-----.-----.                      ,-----.-----.-----.-----.-----.
# |     |     |     |     |     |                      |     |     |     |     |     |
# |-----+-----+-----+-----+-----|                      |-----+-----+-----+-----+-----|
# |     |     |     |     |     |                      |     |     |     |     |     |
# |-----+-----+-----+-----+-----+                      |-----+-----+-----+-----+-----|
# |     |     |     |     |     |                      |     |     |     |     |     |
# `-----'-----'-----'-----'-----'                      `-----'-----'-----'-----'-----'
#               .-------.-------.-------.      .-------.-------.-------.
#               |       |       |       |      | EXIT  |       |OS(SFT)|
#               '-----------------------'      '-------'-------'-------'
#
# Kebab
# ,-----.-----.-----.-----.-----.                      ,-----.-----.-----.-----.-----.
# |     |     |     |     |     |                      |     |     |     |     |     |
# |-----+-----+-----+-----+-----|                      |-----+-----+-----+-----+-----|
# |     |     |     |     |     |                      |     |     |     |     |     |
# |-----+-----+-----+-----+-----+                      |-----+-----+-----+-----+-----|
# |     |     |     |     |     |                      |     |     |     |     |     |
# `-----'-----'-----'-----'-----'                      `-----'-----'-----'-----'-----'
#               .-------.-------.-------.      .-------.-------.-------.
#               |       |       |       |      | EXIT  |       |   -   |
#               '-----------------------'      '-------'-------'-------'

import board
from kb import KMKKeyboard, Mapper36, add_keyboard_layer
from kmk.keys import KC
from kmk.modules.layers import Layers
from kmk.modules.modtap import ModTap
from kmk.modules.oneshot import OneShot
from kmk.modules.mouse_keys import MouseKeys
from kmk.modules.tapdance import TapDance

keyboard = KMKKeyboard()

keyboard.modules.extend([ Layers(), ModTap(), OneShot(), MouseKeys(), TapDance() ])

# --------------- Layer Indexes ---------------

qwerty = Mapper36()
colemak = Mapper36()
numbers = Mapper36()
power = Mapper36()
fkeys = Mapper36()
upper_snake = Mapper36()
snake = Mapper36()
camel = Mapper36()
kebab = Mapper36()

# --------------- Key Definitions and Aliases ---------------

_______ = KC.TRNS
XXXXXXX = KC.NO
NEXTWIN = KC.LGUI(KC.GRAVE)
QWERTY = KC.DF(qwerty.layer_id)
COLEMAK = KC.DF(colemak.layer_id)
RET = KC.LALT(KC.ASTR)
LKUP = KC.LALT(KC.DOT)
LCTRL_TAB = KC.LCTRL(KC.TAB)
GUI_T = KC.MT(KC.T, KC.LGUI(KC.T), prefer_hold=False, tap_time=300)
GUI_X = KC.MT(KC.X, KC.LGUI(KC.X), prefer_hold=False, tap_time=300)
GUI_C = KC.MT(KC.C, KC.LGUI(KC.C), prefer_hold=False, tap_time=300)
GUI_V = KC.MT(KC.V, KC.LGUI(KC.V), prefer_hold=False, tap_time=300)
GUI_M = KC.MT(KC.M, KC.LGUI(KC.M), prefer_hold=False, tap_time=300)
USNAKE_TG = KC.TG(upper_snake.layer_id)
SNAKE_TG = KC.TG(snake.layer_id)
CAMEL_TG = KC.TG(camel.layer_id)
KEBAB_TG = KC.TG(kebab.layer_id)

# Fancy mod-tap/layer-tap multi-function keys
SHIFT_Z = KC.MT(KC.Z, KC.LSFT, prefer_hold=True)
SHIFT_SLASH = KC.MT(KC.SLASH, KC.RSFT, prefer_hold=True)
SHIFT_BACKSLASH = KC.MT(KC.BACKSLASH, KC.RSFT, prefer_hold=True)
LGUI_ESC = KC.MT(KC.ESC, KC.LGUI, prefer_hold=True)
CTRL_TAB = KC.MT(KC.TAB, KC.LCTRL, prefer_hold=True)
ALT_PWR = KC.TD(KC.LALT, KC.MO(power.layer_id))
NUM_ENTER = KC.LT(numbers.layer_id, KC.ENTER, prefer_hold=True)
HYPR_SPACE = KC.MT(KC.SPACE, KC.HYPR, prefer_hold=False)
FKEY_BKSP = KC.LT(fkeys.layer_id, KC.BKSP, prefer_hold=False)

# --------------- Key maps ---------------

qwerty.left(
    KC.Q,       KC.W,       KC.E,       KC.R,       GUI_T,
    KC.A,       KC.S,       KC.D,       KC.F,       KC.G,
    SHIFT_Z,    GUI_X,      GUI_C,      GUI_V,      KC.B,
                            LGUI_ESC,   CTRL_TAB,   ALT_PWR
)
qwerty.right(
    KC.Y,       KC.U,       KC.I,       KC.O,       KC.P,
    KC.H,       KC.J,       KC.K,       KC.L,       KC.SEMICOLON,
    KC.N,       GUI_M,      KC.COMMA,   KC.DOT,     SHIFT_SLASH,
    FKEY_BKSP,  NUM_ENTER,  HYPR_SPACE
)

colemak.left(
    KC.Q,       KC.W,       KC.F,       KC.P,       KC.B,
    KC.A,       KC.R,       KC.S,       KC.T,       KC.G,
    SHIFT_Z,    KC.X,       KC.C,       KC.D,       KC.V,
                            LGUI_ESC,   CTRL_TAB,   ALT_PWR
)
colemak.right(
    KC.J,       KC.L,       KC.U,       KC.Y,       KC.SEMICOLON,
    KC.M,       KC.N,       KC.E,       KC.I,       KC.O,
    KC.K,       KC.H,       KC.COMMA,   KC.DOT,     SHIFT_SLASH,
    FKEY_BKSP,  NUM_ENTER,  HYPR_SPACE
)

numbers.left(
    KC.N1,      KC.N2,      KC.N3,      KC.N4,      KC.N5,
    KC.GRAVE,   KC.HOME,    KC.PGUP,    KC.PGDN,    KC.END,
    KC.LSFT,    KC.EQUAL,   KC.LBRC,    KC.RBRC,    KC.MINUS,
                            _______,    _______,    _______
)
numbers.right(
    KC.N6,      KC.N7,      KC.N8,      KC.N9,      KC.N0,
    KC.LEFT,    KC.DOWN,    KC.UP,      KC.RIGHT,   KC.QUOTE,
    NEXTWIN,    XXXXXXX,    XXXXXXX,    XXXXXXX,    SHIFT_BACKSLASH,
    KC.BKSP,    _______,    _______
)

# Change space to dash - exit with ESC
power.left(
    KC.TAB,     XXXXXXX,    XXXXXXX,    XXXXXXX,    XXXXXXX,
    LCTRL_TAB,  XXXXXXX,    XXXXXXX,    XXXXXXX,    XXXXXXX,
    _______,    XXXXXXX,    XXXXXXX,    XXXXXXX,    XXXXXXX,
                            _______,    _______,    _______
)
power.right(
    XXXXXXX,    XXXXXXX,    XXXXXXX,    XXXXXXX,    KC.UNDS,
    KC.MINUS,   LKUP,       RET,        XXXXXXX,    KC.PLUS,
    USNAKE_TG,  SNAKE_TG,   CAMEL_TG,   KEBAB_TG,   _______,
    KC.BKSP,    KC.ENTER,   KC.SPACE
)

fkeys.left(
    KC.F1,      KC.F2,      KC.F3,      KC.F4,      KC.F5,
    KC.F11,     KC.F12,     XXXXXXX,    XXXXXXX,    XXXXXXX,
    KC.LSFT,    XXXXXXX,    KC.CAPS,    QWERTY,     COLEMAK,
                            _______,    _______,    _______
)
fkeys.right(
    KC.F6,      KC.F7,     KC.F8,      KC.F9,      KC.F10,
    KC.MS_LEFT, KC.MS_DOWN,KC.MS_UP,   KC.MS_RIGHT,XXXXXXX,
    KC.MB_LMB,  KC.MB_RMB, XXXXXXX,    XXXXXXX,    KC.RSFT,
    _______,    _______,   KC.SPACE
)

upper_snake.left(
    KC.LSFT(KC.Q), KC.LSFT(KC.W), KC.LSFT(KC.E), KC.LSFT(KC.R), KC.LSFT(KC.T),
    KC.LSFT(KC.A), KC.LSFT(KC.S), KC.LSFT(KC.D), KC.LSFT(KC.F), KC.LSFT(KC.G),
    KC.LSFT(KC.Z), KC.LSFT(KC.X), KC.LSFT(KC.C), KC.LSFT(KC.V), KC.LSFT(KC.B),
                                  USNAKE_TG,     _______,       _______
)
upper_snake.right(
    KC.LSFT(KC.Y), KC.LSFT(KC.U), KC.LSFT(KC.I), KC.LSFT(KC.O), KC.LSFT(KC.P),
    KC.LSFT(KC.H), KC.LSFT(KC.J), KC.LSFT(KC.K), KC.LSFT(KC.L), _______,
    KC.LSFT(KC.N), KC.LSFT(KC.M), _______,       _______,       _______,
    _______,       _______,       KC.UNDS
)

# Change space to underscore - exit with ESC
snake.left(
    _______,    _______,    _______,    _______,    _______,
    _______,    _______,    _______,    _______,    _______,
    _______,    _______,    _______,    _______,    _______,
                            SNAKE_TG,   _______,    _______
)
snake.right(
    _______,    _______,    _______,    _______,    _______,
    _______,    _______,    _______,    _______,    _______,
    _______,    _______,    _______,    _______,    _______,
    _______,    _______,    KC.UNDS
)

# Change space to one-shot shift - exit with ESC. Note: 'z' key
# doesn't work because of MT on 'z' key.
camel.left(
    _______,    _______,    _______,    _______,    KC.T,
    _______,    _______,    _______,    _______,    _______,
    _______,    KC.X,       KC.C,       KC.V,       _______,
                            CAMEL_TG,   _______,    _______
)
camel.right(
    _______,    _______,    _______,    _______,    _______,
    _______,    _______,    _______,    _______,    _______,
    _______,    KC.M,       _______,    _______,    _______,
    _______,    _______,    KC.OS(KC.LSFT)
)

# Change space to dash - exit with ESC
kebab.left(
    _______,    _______,    _______,    _______,    _______,
    _______,    _______,    _______,    _______,    _______,
    _______,    _______,    _______,    _______,    _______,
                            KEBAB_TG,   _______,    _______
)
kebab.right(
    _______,    _______,    _______,    _______,    _______,
    _______,    _______,    _______,    _______,    _______,
    _______,    _______,    _______,    _______,    _______,
    _______,    _______,    KC.MINUS
)

# fmt: off
# flake8: noqa
add_keyboard_layer(keyboard,
                   qwerty,
                   colemak,
                   numbers,
                   power,
                   fkeys,
                   upper_snake,
                   snake,
                   camel,
                   kebab)

if __name__ == "__main__":
    keyboard.go()
